(()=>{"use strict";class e{constructor(e,t){this.shipType=e,this.length=t,this.health=t,this.rotation="vertical",this.isDeployed=!1,this.isSink=!1,this.coordinates=[],this.playerShips=[],this.computerShips=[]}static createShipArray(){return[new e("submarine",2),new e("destroyer",3),new e("destroyer",3),new e("cruiser",4),new e("carrier",5)]}static setPlayerShips(){return this.playerShips=this.createShipArray()}static getPlayerShips(){return this.playerShips}}const t=e.createShipArray();class o{static createGameBoard(e){for(let t=0;t<100;t++){const o=document.createElement("div");o.classList.add("grid"),o.setAttribute("id",`${t}`),o.textContent=t,e.appendChild(o)}}static deployShipsRandomly(e,t){for(;t.length>0;){let a=Math.floor(101*Math.random()),l=0===Math.floor(2*Math.random())?"vertical":"horizontal";o.isShipDeployable(e,a,t[0].length,l)&&(r.setGridColor(e,a,t[0].length,l,"black","white"),t.shift())}}static isShipDeployable(e,t,o,r){const a=t+o-1;let l=[t];for(let e=1;e<o;e++){let o;o="horizontal"===r?t+e:t+10*e,l.push(o)}return!(l.some((t=>t>99||"black"===e.childNodes[t].style.backgroundColor))||"horizontal"===r&&t<10&&t.toString().length!==a.toString().length||"horizontal"===r&&t>9&&t.toString().split("")[0]!==a.toString().split("")[0])}static changeToPlayPhase(){const e=document.getElementById("modal-ship-info"),r=document.querySelectorAll(".gameboard-title"),a=document.querySelector(".rotate-button"),l=document.querySelector(".random-deploy-button"),i=document.getElementById("player-gameboard-main"),s=document.getElementById("player-game-board"),n=document.getElementById("computer-gameboard-main"),d=document.getElementById("computer-game-board");for(let e=0;e<100;e++)"black"!==s.childNodes[e].style.backgroundColor&&(s.childNodes[e].textContent="");r.forEach((e=>e.style.display="block")),i.style.transform="translate(-100%)",i.style.animation="slide-left 1s",n.style.display="flex",n.style.flexDirection="column",e.style.display="none",a.style.display="none",l.style.display="none",o.deployShipsRandomly(d,t)}}class r{static createPlayerGameBoard(){const e=document.getElementById("player-game-board");e.classList.add("game-board"),o.createGameBoard(e)}static setGridColor(e,t,o,r,a,l){for(let i=1;i<o;i++){let o;o="horizontal"===r?t+i:t+10*i,e.childNodes[t].style.backgroundColor=a,e.childNodes[o].style.backgroundColor=a,l&&(e.childNodes[t].style.color=l),e.childNodes[o].style.color=l}}static setShipInfo(e){let t=document.querySelector(".ship-info-text"),o=document.querySelector(".ship-img");t.textContent=e[0].toUpperCase()+e.slice(1),o.src=`/dist/img/${e}.png`,o.alt=`${e} image`}static switchShipRotation(){const t=document.querySelector(".rotate-button"),o=e.getPlayerShips();t.addEventListener("click",(()=>{o.map((e=>"vertical"===e.rotation?e.rotation="horizontal":e.rotation="vertical"))}))}static deployPlayerShipsRandomly(){const t=document.querySelector(".random-deploy-button"),r=document.getElementById("player-game-board"),a=e.getPlayerShips();t.addEventListener("click",(()=>o.deployShipsRandomly(r,a)))}static deployShip(){const t=document.querySelectorAll(".grid"),r=document.getElementById("player-game-board"),a=e.getPlayerShips();t.forEach((e=>e.addEventListener("click",(()=>{const t=Number(e.id);a[0]&&o.isShipDeployable(r,t,a[0].length,a[0].rotation)&&(this.setGridColor(r,t,a[0].length,a[0].rotation,"black","white"),a.shift(),a[0]&&this.setShipInfo(a[0].shipType))}))))}static gridHoverEffects(){const t=document.querySelectorAll(".grid"),r=document.getElementById("player-game-board"),a=e.getPlayerShips();t.forEach((e=>{e.addEventListener("mouseover",(()=>{const t=Number(e.id);a[0]&&o.isShipDeployable(r,t,a[0].length,a[0].rotation)&&this.setGridColor(r,t,a[0].length,a[0].rotation,"gray")}))})),t.forEach((e=>e.addEventListener("mouseout",(()=>{const t=Number(e.id);a[0]&&o.isShipDeployable(r,t,a[0].length,a[0].rotation)&&this.setGridColor(r,t,a[0].length,a[0].rotation,"white")}))))}static endDeploymentPhase(){const t=document.querySelectorAll(".grid"),r=document.querySelector(".random-deploy-button"),a=e.getPlayerShips();r.addEventListener("click",(()=>o.changeToPlayPhase())),t.forEach((e=>e.addEventListener("click",(()=>{0===a.length&&o.changeToPlayPhase()}))))}}e.setPlayerShips(),r.createPlayerGameBoard(),r.deployPlayerShipsRandomly(),r.switchShipRotation(),r.gridHoverEffects(),r.deployShip(),r.endDeploymentPhase(),class{static createComputerGameBoard(){const e=document.getElementById("computer-game-board");e.classList.add("game-board"),o.createGameBoard(e);for(let t=0;t<100;t++)e.childNodes[t].textContent=""}static getPlayerCoordinates(){const e=document.querySelectorAll(".grid");let t=[];return e.forEach((e=>{"black"===e.style.backgroundColor&&t.push(e.id)})),t}}.createComputerGameBoard()})();